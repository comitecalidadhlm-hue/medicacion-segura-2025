<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medicación Segura - Juego Educativo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .shake-animation {
            animation: shake 0.5s;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body class="bg-blue-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-blue-800 mb-2">Medicación Segura</h1>
            <p class="text-lg text-blue-600">Juego educativo sobre protocolos de administración de medicamentos</p>
            <div class="mt-4 flex justify-center">
                <div class="bg-white rounded-lg shadow-lg p-4 w-full max-w-md">
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-semibold">Nivel: <span id="level">1</span>/11</span>
                        <span class="font-semibold">Puntos: <span id="points">0</span></span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-4">
                        <div id="progress-bar" class="bg-blue-600 h-4 rounded-full" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Game Area -->
        <div class="bg-white rounded-xl shadow-xl overflow-hidden mb-8 transition-all duration-300 fade-in" id="game-container">
            <!-- Scenario Introduction -->
            <div id="scenario-intro" class="p-6">
                <h2 class="text-2xl font-bold text-blue-800 mb-4">Bienvenido al Servicio de Medicina</h2>
                <div class="bg-blue-100 border-l-4 border-blue-500 p-4 mb-6">
                    <p class="text-blue-800">Eres un profesional de la salud responsable de administrar medicación a los pacientes. Debes seguir los protocolos de seguridad para evitar errores de medicación.</p>
                </div>
                <div class="flex justify-center">
                    <button onclick="startGame()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg text-lg flex items-center pulse-animation">
                        <i class="fas fa-play mr-2"></i> Comenzar Juego
                    </button>
                </div>
            </div>

            <!-- Game Content (dynamically loaded) -->
            <div id="game-content" class="hidden p-6"></div>

            <!-- Feedback Modal -->
            <div id="feedback-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                <div class="bg-white rounded-lg p-6 max-w-md mx-4">
                    <div id="feedback-content" class="text-center"></div>
                    <div class="mt-6 flex justify-center">
                        <button onclick="closeFeedback()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg">
                            Continuar
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Info Panel -->
        <div class="bg-white rounded-xl shadow-xl p-6 mb-8">
            <h2 class="text-xl font-bold text-blue-800 mb-4">Protocolos de Medicación Segura</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <div class="bg-blue-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-blue-700 mb-2"><i class="fas fa-hand-holding-water mr-2"></i>Higiene de Manos</h3>
                    <p class="text-sm">5 momentos según la OMS: antes del contacto con el paciente, antes de realizar una tarea limpia/aséptica, después del riesgo de exposición a líquidos corporales, después del contacto con el paciente, después del contacto con el entorno del paciente.</p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-blue-700 mb-2"><i class="fas fa-prescription-bottle-alt mr-2"></i>Ruta de la Medicación</h3>
                    <p class="text-sm">Verificar prescripción completa, presentación del fármaco, concentración y dilución, velocidad de infusión.</p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-blue-700 mb-2"><i class="fas fa-user-check mr-2"></i>Identificar al Paciente</h3>
                    <p class="text-sm">2 identificadores: nombre completo y número de documento o fecha de nacimiento. Verificar unidad y cama correcta.</p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-blue-700 mb-2"><i class="fas fa-allergies mr-2"></i>Investigación de Alergias</h3>
                    <p class="text-sm">Revisar brazalete e historia clínica. Verificar interacciones medicamentosas.</p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-blue-700 mb-2"><i class="fas fa-notes-medical mr-2"></i>Los 10 Correctos</h3>
                    <p class="text-sm">Paciente, medicamento, dosis, vía, hora, documentación, forma, compatibilidad, diluyente, velocidad.</p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-blue-700 mb-2"><i class="fas fa-exclamation-triangle mr-2"></i>Evento Adverso</h3>
                    <p class="text-sm">Detener infusión, estabilizar paciente, notificar al médico, reportar en sistema de farmacovigilancia.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Game variables
        let currentLevel = 0;
        let points = 0;
        const totalLevels = 11;
        const scenarios = [
            {
                title: "Higiene de Manos",
                description: "Estás a punto de administrar medicación a un paciente. ¿Cuál es el primer paso que debes realizar?",
                options: [
                    { text: "Lavarme las manos con agua y jabón", correct: true, feedback: "¡Correcto! La higiene de manos es el primer paso fundamental para prevenir infecciones." },
                    { text: "Verificar la identidad del paciente", correct: false, feedback: "Primero debes lavarte las manos para garantizar la seguridad del paciente." },
                    { text: "Preparar el medicamento", correct: false, feedback: "Antes de manipular cualquier medicamento, es esencial la higiene de manos." }
                ],
                image: "🧼"
            },
            {
                title: "Ruta de la Medicación Segura",
                description: "Tienes una prescripción de 'Paracetamol 1g IV cada 8 horas'. ¿Qué elementos debes verificar antes de preparar el medicamento?",
                options: [
                    { text: "Solo el nombre del medicamento", correct: false, feedback: "Debes verificar todos los elementos de la prescripción para garantizar seguridad." },
                    { text: "Nombre, dosis, vía y frecuencia", correct: true, feedback: "¡Excelente! Una prescripción completa debe incluir nombre, dosis, vía y frecuencia." },
                    { text: "Solo la firma del médico", correct: false, feedback: "La firma es importante, pero no es lo único que debes verificar." }
                ],
                image: "💊"
            },
            {
                title: "Identificación del Paciente",
                description: "Estás en la habitación 402 para administrar medicación. ¿Cómo verificas que es el paciente correcto?",
                options: [
                    { text: "Preguntar solo el nombre", correct: false, feedback: "Se necesitan al menos dos identificadores para verificar correctamente al paciente." },
                    { text: "Verificar nombre completo y fecha de nacimiento", correct: true, feedback: "¡Perfecto! Dos identificadores (nombre y fecha de nacimiento) son esenciales." },
                    { text: "Confirmar solo el número de cama", correct: false, feedback: "El número de cama no es suficiente, puede haber cambios en la asignación." }
                ],
                image: "🆔"
            },
            {
                title: "Investigación de Alergias",
                description: "El paciente tiene una prescripción de Penicilina. ¿Dónde debes verificar si tiene alergias conocidas?",
                options: [
                    { text: "Solo en el brazalete del paciente", correct: false, feedback: "Debes verificar tanto el brazalete como la historia clínica para información completa." },
                    { text: "Brazalete e historia clínica", correct: true, feedback: "¡Correcto! Ambos son fuentes esenciales para verificar alergias." },
                    { text: "Preguntar al paciente si recuerda tener alergias", correct: false, feedback: "Aunque importante, no es suficiente confiar solo en la memoria del paciente." }
                ],
                image: "⚠️"
            },
            {
                title: "Almacenamiento de Medicamentos",
                description: "Debes administrar Insulina. ¿Cómo debe estar almacenada antes de su uso?",
                options: [
                    { text: "A temperatura ambiente", correct: false, feedback: "La insulina generalmente requiere refrigeración antes de su uso." },
                    { text: "Refrigerada (2-8°C)", correct: true, feedback: "¡Bien hecho! La insulina debe refrigerarse entre 2-8°C." },
                    { text: "Congelada", correct: false, feedback: "Nunca se debe congelar la insulina, ya que pierde su eficacia." }
                ],
                image: "❄️"
            },
            {
                title: "Etiquetado de Medicamentos",
                description: "Estás preparando KCl para infusión. ¿Qué tipo de etiqueta especial requiere?",
                options: [
                    { text: "Etiqueta roja de alto riesgo", correct: true, feedback: "¡Correcto! Los electrolitos concentrados como KCl requieren etiqueta roja." },
                    { text: "Etiqueta amarilla de precaución", correct: false, feedback: "Los medicamentos de alto riesgo requieren etiqueta roja, no amarilla." },
                    { text: "No necesita etiqueta especial", correct: false, feedback: "Los electrolitos concentrados siempre requieren identificación especial." }
                ],
                image: "🏷️"
            },
            {
                title: "Alertas LASA",
                description: "Tienes que administrar 'Hydralazine'. ¿Qué precaución debes tomar con medicamentos LASA?",
                options: [
                    { text: "Verificar nombre y envase cuidadosamente", correct: true, feedback: "¡Exacto! Los medicamentos LASA requieren doble verificación por similitud." },
                    { text: "Administrarlo más rápido por ser similar", correct: false, feedback: "Nunca debes acelerar la administración por esta razón." },
                    { text: "Ignorar las alertas porque conoces el medicamento", correct: false, feedback: "Las alertas LASA siempre deben ser consideradas, sin excepciones." }
                ],
                image: "🔍"
            },
            {
                title: "Los 10 Correctos",
                description: "¿Cuál de estas opciones NO es parte de los 10 correctos en administración de medicamentos?",
                options: [
                    { text: "Paciente correcto", correct: false, feedback: "Este sí es uno de los 10 correctos." },
                    { text: "Color correcto del medicamento", correct: true, feedback: "¡Correcto! El color no está entre los 10 correctos (es paciente, medicamento, dosis, vía, hora, documentación, forma, compatibilidad, diluyente, velocidad)." },
                    { text: "Vía correcta", correct: false, feedback: "La vía de administración sí es uno de los 10 correctos." }
                ],
                image: "✅"
            },
            {
                title: "Doble Verificación",
                description: "Estás preparando una dosis de Heparina. ¿Qué debe incluir la doble verificación con otro profesional?",
                options: [
                    { text: "Solo contar las gotas", correct: false, feedback: "La doble verificación debe ser mucho más completa." },
                    { text: "Prescripción, presentación, dilución y cálculo", correct: true, feedback: "¡Perfecto! Todos estos elementos son esenciales en la doble verificación." },
                    { text: "Solo verificar el nombre del paciente", correct: false, feedback: "La doble verificación debe incluir múltiples aspectos del proceso." }
                ],
                image: "👥"
            },
            {
                title: "Administración Segura",
                description: "Debes administrar un antibiótico IV. ¿Qué precaución es esencial para la vía intravenosa?",
                options: [
                    { text: "Usar el mismo lumen para todos los medicamentos", correct: false, feedback: "Algunos medicamentos requieren lumen exclusivo por incompatibilidades." },
                    { text: "Rotular el circuito de infusión", correct: true, feedback: "¡Correcto! Rotular el circuito ayuda a prevenir errores." },
                    { text: "Administrar rápidamente para ahorrar tiempo", correct: false, feedback: "La velocidad debe ser siempre la prescrita, nunca acelerar arbitrariamente." }
                ],
                image: "💉"
            },
            {
                title: "Evento Adverso",
                description: "Durante una infusión, el paciente presenta dificultad respiratoria. ¿Cuál es tu primera acción?",
                options: [
                    { text: "Detener la infusión inmediatamente", correct: true, feedback: "¡Exacto! La primera acción es siempre detener la infusión ante una reacción adversa." },
                    { text: "Aumentar el flujo de oxígeno", correct: false, feedback: "Primero debes detener la infusión que puede estar causando la reacción." },
                    { text: "Llamar al médico sin hacer nada más", correct: false, feedback: "Debes actuar inmediatamente deteniendo la infusión mientras llamas al médico." }
                ],
                image: "🚨"
            }
        ];

        // Start the game
        function startGame() {
            document.getElementById('scenario-intro').classList.add('hidden');
            document.getElementById('game-content').classList.remove('hidden');
            loadLevel(0);
        }

        // Load a specific level
        function loadLevel(levelIndex) {
            currentLevel = levelIndex;
            document.getElementById('level').textContent = currentLevel + 1;
            document.getElementById('progress-bar').style.width = `${(currentLevel / totalLevels) * 100}%`;
            
            const scenario = scenarios[levelIndex];
            const gameContent = document.getElementById('game-content');
            
            gameContent.innerHTML = `
                <div class="mb-6">
                    <div class="flex items-center mb-4">
                        <span class="text-4xl mr-3">${scenario.image}</span>
                        <h2 class="text-2xl font-bold text-blue-800">${scenario.title}</h2>
                    </div>
                    <p class="text-lg mb-6">${scenario.description}</p>
                    
                    <div class="space-y-3">
                        ${scenario.options.map((option, index) => `
                            <button onclick="checkAnswer(${index})" class="w-full text-left bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-lg p-4 transition-colors duration-200">
                                ${option.text}
                            </button>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // Check the selected answer
        function checkAnswer(optionIndex) {
            const scenario = scenarios[currentLevel];
            const selectedOption = scenario.options[optionIndex];
            
            // Add points if correct
            if (selectedOption.correct) {
                points += 10;
                document.getElementById('points').textContent = points;
                showFeedback(selectedOption.feedback, true);
            } else {
                showFeedback(selectedOption.feedback, false);
            }
        }

        // Show feedback modal
        function showFeedback(message, isCorrect) {
            const feedbackModal = document.getElementById('feedback-modal');
            const feedbackContent = document.getElementById('feedback-content');
            
            feedbackContent.innerHTML = `
                <div class="${isCorrect ? 'text-green-600' : 'text-red-600'} text-5xl mb-4">
                    ${isCorrect ? '✓' : '✗'}
                </div>
                <h3 class="text-xl font-bold mb-2">${isCorrect ? '¡Correcto!' : 'Incorrecto'}</h3>
                <p>${message}</p>
            `;
            
            feedbackModal.classList.remove('hidden');
        }

        // Close feedback modal and proceed to next level
        function closeFeedback() {
            document.getElementById('feedback-modal').classList.add('hidden');
            
            // Move to next level or end game
            if (currentLevel < totalLevels - 1) {
                loadLevel(currentLevel + 1);
            } else {
                endGame();
            }
        }

        // End the game and show results
        function endGame() {
            const gameContent = document.getElementById('game-content');
            const percentage = Math.round((points / (totalLevels * 10)) * 100);
            
            gameContent.innerHTML = `
                <div class="text-center py-8">
                    <div class="text-5xl mb-6">🎉</div>
                    <h2 class="text-3xl font-bold text-blue-800 mb-4">¡Juego Completado!</h2>
                    <p class="text-xl mb-6">Has terminado todos los niveles de Medicación Segura.</p>
                    
                    <div class="bg-blue-100 rounded-lg p-6 max-w-md mx-auto mb-6">
                        <h3 class="text-xl font-semibold mb-2">Tu puntuación final:</h3>
                        <div class="text-4xl font-bold text-blue-700">${points}/${totalLevels * 10}</div>
                        <div class="mt-2 text-lg">${percentage}% de respuestas correctas</div>
                    </div>
                    
                    <p class="mb-6">${getPerformanceMessage(percentage)}</p>
                    
                    <button onclick="resetGame()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg text-lg">
                        <i class="fas fa-redo mr-2"></i> Jugar Nuevamente
                    </button>
                </div>
            `;
        }

        // Get performance message based on score
        function getPerformanceMessage(percentage) {
            if (percentage >= 90) {
                return "¡Excelente trabajo! Demuestras un conocimiento excepcional sobre medicación segura.";
            } else if (percentage >= 70) {
                return "Buen trabajo, pero hay algunos conceptos que podrías repasar para mejorar.";
            } else {
                return "Es recomendable que revises los protocolos de medicación segura antes de continuar con la práctica.";
            }
        }

        // Reset the game
        function resetGame() {
            currentLevel = 0;
            points = 0;
            document.getElementById('points').textContent = '0';
            startGame();
        }
    </script>
</body>
</html>
